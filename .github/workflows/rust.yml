name: ğŸ§ª Test cr8s Code

on:
 push:
   branches: [ main ]
 pull_request:
   branches: [ main ]
 workflow_dispatch:

permissions:
 contents: read

jobs:
 test:
   name: Test cr8s Code
   runs-on: ubuntu-latest

   steps:
     - name: â¬‡ï¸ Checkout repository
       uses: actions/checkout@v4

     - name: ğŸ› ï¸ Setup Rust
       uses: actions-rust-lang/setup-rust-toolchain@v1
       with:
         components: rustfmt, clippy

     - name: ğŸ“‹ Format check
       run: cargo fmt --check

     - name: ğŸ” Lint check
       run: cargo clippy --release --all-targets --all-features -- -D warnings

     - name: ğŸ”’ Security audit
       run: cargo audit || cargo outdated || true

     - name: ğŸ§ª Run tests
       run: cargo test --release --all-targets --all-features

     - name: ğŸ› ï¸ Build binaries
       run: cargo build --release --bin server --bin cli

